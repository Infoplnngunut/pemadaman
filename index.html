<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cek Pemadaman PLN - ULP Ngunut</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 600px;
      margin: 2em auto 3em auto;
      padding: 0 1em;
      background: #f0f5ff;
      color: #003366;
    }
    header {
      text-align: center;
      margin-bottom: 1em;
      border-bottom: 3px solid #ffcc00;
      padding-bottom: 0.5em;
    }
    header h1, header h2 {
      margin: 0.2em 0;
    }
    label, input, button {
      display: block;
      width: 100%;
      font-size: 1.2em;
      margin: 1em 0;
    }
    input {
      padding: 0.5em;
      border: 2px solid #ffcc00;
      border-radius: 5px;
      font-weight: bold;
      color: #003366;
    }
    input:focus {
      outline: none;
      border-color: #003366;
      background-color: #ffffcc;
    }
    button {
      background-color: #003366;
      color: #ffcc00;
      border: none;
      padding: 0.7em;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s ease, color 0.3s ease;
      font-weight: bold;
    }
    button:hover {
      background-color: #ffcc00;
      color: #003366;
    }
    #result {
      background: white;
      border: 2px solid #003366;
      padding: 1em;
      border-radius: 5px;
      min-height: 80px;
      color: #003366;
      font-weight: 600;
    }
    .logo {
      display: block;
      margin: 0 auto 1em auto;
      max-width: 120px;
    }
  </style>
</head>
<body>

  <header>
    <img src="pln.png" alt="Logo PLN" class="logo" />
    <h1>PT PLN (Persero) ULP Ngunut</h1>
    <h2>Informasi Terdampak Pemadaman Terencana</h2>
  </header>

  <label for="idNomor">Masukkan ID Pelanggan atau Nomor Meter:</label>
  <input type="text" id="idNomor" placeholder="Contoh: 12345 atau 987654321" autocomplete="off" />
  <button id="searchBtn">Cari</button>

  <div id="result"></div>

  <section id="info-terencana" style="margin-top:2em; padding:1em; border: 2px solid #ffcc00; border-radius:5px; background:#fff8cc; color:#003366;">
    <h2 style="text-align: center;">
      Informasi Pemadaman Terencana
    </h2>
    <p style="font-weight: normal; text-align: justify; margin-top: 1em;">
      Pemadaman listrik terencana dilakukan dalam rangka pemeliharaan jaringan dan peningkatan kualitas layanan. 
      Mohon maaf atas ketidaknyamanan yang ditimbulkan. Apabila pekerjaan selesai sebelum waktu yang telah ditentukan, maka listrik akan dinormalkan kembali.
    </p>
  </section>

<script>
  const encodedData = `
  PHRyPjx0ZD4xMjM0NTwvdGQ+PHRkPjk4NzY1NDMyMTwvdGQ+PHRkPkFuZGkgU2V0aWF3YW48L3RkPjx0ZD4yMDI1LTA3LTAzIDA4OjAwIC0gMTA6MDA8L3RkPjwvdHI+PHRyPjx0ZD42Nzg5MDwvdGQ+PHRkPjEyMzQ1Njc4OTwvdGQ+PHRkPkJ1ZGkgU2FudG9zbzwvdGQ+PHRkPjIwMjUtMDctMDMgMDk6MDAgLSAxMTowMDwvdGQ+PC90cj48dHI+PHRkPjExMjIzPC90ZD48dGQ+MTExMjIyMzMzPC90ZD48dGQ+Q2l0cmEgV2lqYXlhPC90ZD48dGQ+MjAyNS0wNy0wMyAwNzozMCAtIDA5OjMwPC90ZD48L3RyPg==
  `.replace(/\s/g, '');

  function decodeData() {
    const decodedStr = atob(encodedData);
    const parser = new DOMParser();
    const doc = parser.parseFromString(`<table>${decodedStr}</table>`, 'text/html');
    const rows = doc.querySelectorAll('tr');
    const data = [];
    rows.forEach(row => {
      const cells = row.querySelectorAll('td');
      if (cells.length === 4) {
        data.push({
          id: cells[0].textContent.trim(),
          nomorMeter: cells[1].textContent.trim(),
          nama: cells[2].textContent.trim(),
          waktu: cells[3].textContent.trim()
        });
      }
    });
    return data;
  }

  function isValidInput(input) {
    return /^[a-zA-Z0-9]{5,}$/.test(input);
  }

  function sensorAngka(str) {
    if (str.length <= 2) return '*'.repeat(str.length);
    return str[0] + '*'.repeat(str.length - 2) + str[str.length - 1];
  }

  function sensorNama(nama) {
    return nama
      .split(' ')
      .map(kata => {
        if (kata.length <= 2) return kata[0] + '*';
        return kata[0] + '*'.repeat(kata.length - 2) + kata[kata.length - 1];
      })
      .join(' ');
  }

  document.getElementById('searchBtn').addEventListener('click', () => {
    const input = document.getElementById('idNomor').value.trim();
    const resultDiv = document.getElementById('result');

    if (!input) {
      resultDiv.textContent = 'Masukkan ID Pelanggan atau Nomor Meter terlebih dahulu.';
      return;
    }

    if (!isValidInput(input)) {
      resultDiv.textContent = 'Input tidak valid. Gunakan huruf dan angka minimal 5 karakter.';
      return;
    }

    resultDiv.textContent = 'Mencari...';

    const data = decodeData();
    const ditemukan = data.find(d => d.id === input || d.nomorMeter === input);

    if (ditemukan) {
      resultDiv.innerHTML = `
        <p><strong>ID Pelanggan:</strong> ${sensorAngka(ditemukan.id)}</p>
        <p><strong>Nomor Meter:</strong> ${sensorAngka(ditemukan.nomorMeter)}</p>
        <p><strong>Nama:</strong> ${sensorNama(ditemukan.nama)}</p>
        <p><strong>Waktu Pemadaman:</strong> ${ditemukan.waktu}</p>
      `;
    } else {
      resultDiv.textContent = 'Data tidak ditemukan atau tidak terdampak pemadaman.';
    }
  });

  document.getElementById('idNomor').addEventListener('keydown', e => {
    if (e.key === 'Enter') {
      e.preventDefault();
      document.getElementById('searchBtn').click();
    }
  });
</script>

</body>
</html>
